#!/usr/bin/env python

import ConfigParser
from functools import partial as PL

config_file = '/etc/easydr/easydr.conf'

cp = ConfigParser.ConfigParser()
cp.read(config_file)

def get_value(section_name, option_name, get_bool=False, read_common=False):
    try:
        if get_bool:
            value = cp.getboolean(section_name,option_name)
        else:
            value = cp.get(section_name,option_name)
    except:
	if read_common:
            try:
	        if get_bool:
                    value  = cp.getboolean('common', option_name)
	        else:
                    value  = cp.get('common', option_name)
            except:
	        if get_bool:
                    value = False
	        else:
		    raise
	else:
	    raise
    return value

get_bool_common_value = PL(get_value, get_bool=True, read_common=True)
get_common_value = PL(get_value, read_common=True)

debug_dr = get_bool_common_value('dr','debug')
debug_vi = get_bool_common_value('vi','debug')
# 
# get musers_dr
#
try:
    musers_dr = [ n.strip() for n in get_common_value('dr','musers').split(',') ]
except:
    musers_dr = []
# 
# get mpks
#
try:
    mpks = [ n.strip() for n in get_value('dr','mpks').split(',') if len(n.strip()) >= 5 ]
except:
    mpks = []
# 
# get musers_vi
#
try:
    musers_vi = [ n.strip() for n in get_common_value('vi','musers').split(',') ]
except:
    musers_vi = []

__all__ = ['debug_dr', 'debug_vi', 'musers_dr', 'mpks', 'musers_vi']
